---
{"dg-home":false,"dg-pinned":false,"dg-home-link":false,"dg-permalink":"note-20250605122815","disabled rules":null,"dg-publish":true,"created-date":"2025-05-06T12:28:30","updated-date":"2025-05-08T09:43:19","type":"other","title":"My Digital Garden Setup","aliases":["My Digital Garden Setup"],"linter-yaml-title-alias":"My Digital Garden Setup","dg-path":"Note-0250605122815.md","permalink":"/note-20250605122815/","dgPassFrontmatter":true}
---



This page is dedicated to my current website setup, my customizations, bugs, rough edges which still exist and potential workarounds.

## The Setup
- I write texts within [Obsidian.md](https://obsidian.md).
- I use the plugin [Obsidian Digital Garden](https://dg-docs.ole.dev), which publishes notes of my choosing firstly into a GitHub Repository.
- Said repo is derived from [this template](https://github.com/oleeskild/digitalgarden), which houses an [11ty](https://www.11ty.dev) project.
- 11ty produces a static page which is then deployed with [GitHub Pages](https://www.11ty.dev).

## Issues, Bugs and Customisations
Here I track any issues I've encountered so far and how I deal with them.

Whenever possible, I want to fix issues directly in Obsidian, so that my Obsidian view of the texts I publish stays close to what is actually produced.
The next best thing is to customize the Digital Garden template [the way it's meant to be customized](https://dg-docs.ole.dev/advanced/adding-custom-components/), to avoid hassle when updating the template in the future. If the customization options are not sufficient, I look next at fixing this in the files outside of the customization paths in the template, which comes at the price of overhead when updating the template.
If it's not fixable in the template, the last resort is fixing this in the plugin directly.

### Deploying to GitHub Pages
**Status:** Resolved ‚úÖ

**Description:** The plugin is [mainly aimed at Vercel](https://dg-docs.ole.dev/getting-started/01-getting-started/), and lists Github Pages only [somewhere in the "Other" section](https://dg-docs.ole.dev/advanced/hosting-alternatives/). There is no documentation on how to deploy to GitHub Pages.

**Solution:**
- Clone the [Template Repository](https://github.com/oleeskild/digitalgarden). It needs to be public, and it needs to be named `(yourname).github.io` as per the [GitHub Pages Documentation.](https://docs.github.com/en/pages/getting-started-with-github-pages/creating-a-github-pages-site)
- Follow the set up of the Digital Garden plugin to connect Obsidian to that repository.
- In the repository settings, under "Pages", finish the setup of the page. As "Source", select "GitHub Actions".
- If GitHub comes with its own workflow, remove it (you can do this in the Actions tab in GitHub). You should also remove the build workflow the template comes with by deleting `.github/workflows/build.yaml` from the repository.
- Place the `main.yaml` from below into `.github/workflows/` to activate the workflow that builds the site.
- **Done!** (Note that 404s do not work properly in all cases at this stage, there's a description on how to resolve it [[#Make 404s work with GitHub Pages|below]].

> [!example]- `main.yaml` to deploy the Digital Garden to GitHub Pages
>  ```
> name: GH Pages
> 
> on:
>   push:
>     branches:
>       - main  # Set a branch name to trigger deployment
>   # Allows you to run this workflow manually from the Actions tab
>   workflow_dispatch:      
>   pull_request:
> permissions:
>   contents: read
>   pages: write
>   id-token: write    
> concurrency:
>   group: "pages"
>   cancel-in-progress: false  
> jobs:
>   deploy:
>     environment:
>       name: github-pages
>       url: ${{ steps.deployment.outputs.page_url }}
>     runs-on: ubuntu-latest
> 
>     steps:
>       - uses: actions/checkout@v4
>       - name: Setup Node
>         uses: actions/setup-node@v4
>         with:
>           node-version: '23'
>         
>       - run: npm install
>       - run: npm run build 
>       - name: Setup Pages
>         uses: actions/configure-pages@v5
>       - name: Upload artifact
>         uses: actions/upload-pages-artifact@v3
>         with:
>           path: 'dist'
>       - name: Deploy to GitHub Pages
>         id: deployment
>         uses: actions/deploy-pages@v4
>           
>  ```
>  

### Formatting breaks if there is no line break above a heading
**Status:** Worked around ‚úÖ

**Description:** Obsidian renders just fine if you put content directly above a heading, but formatting for a Digital Garden note breaks in this case.

**Solution:** I am using [Obsidian Linter anyways](https://github.com/platers/obsidian-linter) , so all I had to do was to enable the rule ["Heading Blank Lines"](https://platers.github.io/obsidian-linter/settings/spacing-rules/#heading-blank-lines). This prevents the offending formatting from happening.

### Inefficient Transclusions
**Status:** Worked around ‚úÖ

**Description:** The plugin doesn't cache transclusions, so if you transclude e.g. a header in every note, then that header file is compiled for every single note again. This results in performance degradation during publishing.

**Solution:** Using transclusions as a header has other drawbacks as well, such as the header showing up in the RSS Feed or the built-in search. The Digital Garden plugin has a [capability to add custom components, such as a Header](https://dg-docs.ole.dev/advanced/adding-custom-components/), which I used instead of transclusions.

### Regular Dataviews produce bogus output
**Status:** Worked around ‚úÖ

**Description:** Dataviews sometimes produce a single `{ .block-language-dataview}`  below the desired result.

**Solution:** I migrated to JS Dataviews first, but I ran into performance issues. Instead, I now remove that line during markdown pre-processing. I do this by extending the `userMarkdownSetup` in the template file `src/helpers/userSetup.js`  as follows:

```JavaScript
function preProcessRule(state) {
    let currentContent = state.src;
    currentContent = currentContent
                        .split('\n')
	                    .filter(line => 
	                        !line
	                            .trim()
	                            .startsWith('{ .block-language-dataview}'))
                                .join('\n');
    state.src = currentContent;
  }
  md.core.ruler.before('normalize', 'user_markdown_preprocessor', preProcessRule);
```

This removes the offending line.

### JS Dataviews have performance issues
**Status:** Partially Resolved ‚è≥

**Description:** JS Dataviews come with a significant performance overhead, as a JS environment needs to be spun up for every note that uses one. I had JS Dataviews in every file, which increased the compile time (needed for publishing) from seconds to minutes.

**Solution**: since most of these dataviews were built to create some kind of header or footer, I replaced most of them with custom components, as described above. There are still some dataviews remaining that I need to migrate.

### Opening the Publication Center on Mobile sometimes causes an app reload
**Status:** Watching üëÄ

**Description:** Pretty much what it says on the tin.

**Solution:** My current assumption is that this is due to the performance issues caused by DataviewJS and that this issue will go away once I solve these performance bottlenecks.

### The first `---` below the front matter is not rendered
**Status:** Resolved ‚úÖ

**Description**: In any markdown file, the first line below the front matter which only contains `---` will disappear instead of rendering a horizontal line.

**Solution:** This is because of the following setting in the template's `eleventy.js`:

```JavaScript
 eleventyConfig.setFrontMatterParsingOptions({
   excerpt: true
  });
```

This treats the first `---` as a signal that everything between the front matter and this separator should be made available as an excerpt, and the `---` is then removed. This can be solved, while retaining the functionality, by changing the options as follows:

```javascript
eleventyConfig.setFrontMatterParsingOptions({
   excerpt: true,
   excerpt_separator: "<!-- excerpt -->"   
});
```

This makes 11ty use the given separator, keeping the `---` intact.

### `dv.current()` is empty in inline dataview JS queries
**Status:** Worked Around ‚úÖ

**Description:** Using `dv.current()` to access the current file in an inline dataview JS query renders just fine in Obsidian but the result is empty on compiling.

**Solution:** My first solution was to use `dv.pages()` in combination with [Templater](https://silentvoid13.github.io/Templater/introduction.html) to get what I wanted. But given the performance issues I observed with dataview as well as the locale issues with Dataview,  I decided to move away from js dataviews. Since I used them effectively for values that belong into the header and footer, I was able to get rid of them by moving that rendering logic to 11ty.

### Dates are parsed inconsistently across devices
**Status:** Worked around ‚úÖ

**Description:** Using dataview to parse dates in a specific format yields to inconsistent results across devices. This is actually an issue with DataView, as on iOS, it uses the locale based on the system device settings for formatting instead of a locale based on the language Obsidian is in. DataView's documentation even states that formatting might have locale issues.

**Solution:** As mentioned in other sections as well, I was using this functionality mainly to replicate header/footer functionality. I moved this to 11ty.

### Unnamed links are not supported
**Status:** Not a Bug

**Description:** Links without a title in the form of `[[note-name]]` are ignored by the plugin.

**Solution:** Works as intended, and since I don't need this feature, I haven't invested in fixing this.

### Links to headers in the same file are not supported
**Status:** Resolved ‚úÖ

**Description:** A link to a heading in the same file, as in: `[[#Unnamed links are not supported|A link to the previous section]]` is not supported and leads to dead links.

**Solution:** In `getAnchorAttributes()` within the `.eleventy.js`, check if `fileName` is empty and if so, set `permalink` to `""` right away instead of attempting to load the file. Lo and behold: [[#Unnamed links are not supported|A link to the previous section]].

### Publishing fails without a visible error
**Status:** Open üêõ

**Description:** When publishing a lot of notes (e.g. by changing a setting which requires a re-publishing of all notes), then publishing of some notes fails. The developer console states that you have hit a secondary rate limit at GitHub. Yet, the plugin shows success for all notes.

**Solution:** None yet. Best workaround is to open the publication center again and check if there are still notes showing up.

### Callout "names" are visible in search
**Status:** Resolved ‚úÖ

**Description:** Obsidian supports different [callouts](https://help.obsidian.md/callouts), and their type is define by a string like `[!info]`. This string shows up in the search.

**Solution:** Extend the function `userEleventySetup` in  `src/helpers/userSetup.js` as follows:

```javascript
eleventyConfig.addFilter("removeObsidianCallouts", function(contentValue) {
  if (!contentValue || typeof contentValue !== 'string') { 
    return contentValue; 
  }
  const calloutRegex = /\[![a-zA-Z0-9-]+(?:\|[a-zA-Z0-9-]+)?\]/g;      
  return contentValue.replace(calloutRegex, '');
});
```

This filter actually filters out all kinds of names as long as they are in square brackets and start with an `!`.

Then, in `src/site/search-index.njk`, use this filter for the content as follows:

```
"content": {{ post.templateContent   | removeObsidianCallouts // rest of line
```

Adding this filter to `src/site/feed.njk` removes these callout names also from the RSS feed.

### Preventing Dead Links
**Status:** Resolved ‚úÖ

**Description:** The plugin does a great job in gracefully handling dead links. Dead links can happen if:

- A published note is linking to a non-existing note
- A published note is linking to a non-published note

In either case, the plugin redirects to the 404 page. However, I do not want dead links at all.

**Solution:** In the `.env` within the template, I have added the following key-value pair:
```
THROW_ON_DEAD_LINKS=true
```

In the `.eleventy.js`, I modified the function `getAnchorAttributes` as follows:

```javascript
function getAnchorAttributes(filePath, linkTitle) {
  // .. other parts of this function..
  if (deadLink) {
    // Start addition
    if (process.env.THROW_ON_DEAD_LINKS === "true") {
      console.log("Dead link detected! Filepath: " + filePath + " | Link title: " + linkTitle);
      throw new Error("Dead link detected! Filepath: " + filePath + " | Link title: " + linkTitle);
    }
    // End addition
    return {
      attributes: {
        "class": "internal-link is-unresolved",
        "href": "/404",
        "target": "",
      },
      innerHTML: title,
    }
  }
```

With this, any build will fail on GitHub if a dead link is detected. The addition to `.env` enables me to toggle this on or off more quickly. Setting `THROW_ON_DEAD_LINKS` to `false` restores the original behaviour.

### The Feed and the Sitemap create incompliant output
**Status:** Resolved ‚úÖ

**Description:** Validation of e.g. the RSS feed fails because of invalid XML. Also, the respective files look a bit weird. For example, look at the following line in `src/site/feed.njk` (notice the extra slashes at the end):

```xml
 <link href="{{ meta.siteBaseUrl }}{{note.url | url }}" ////>
```

**Solution:** 11ty puts all files through a series of transformations in order to produce the result. These are defined in the `.eleventy.js` and are added with `eleventyConfig.addTransform`.
All transforms which call `parse()`, so `dataview-js-links`, `callout-block`, `picture`and `table` transform, by the way they are using the result of `parse`, a tag which is valid HTML to a tag which is invalid XHTML (needed for RSS).
Luckily, none of the transformations are actually needed for the feeds, so to fix this, all these transforms need to ignore files which will produce an XML file.

This can be fixed by amending the transformers as follows:
```javascript
eleventyConfig.addTransform("table", function (str, outputPath) {
   if (outputPath.endsWith(".xml")) { // ‚Üë‚Üë note the outputPath up there ‚Üë‚Üë
     return str;
   }
   // .. remaining code
}
```

With this, the extra slashes in the `feed.njk` and the `sitemap.njk` can be removed.

### Other Issues
These are other issues I encountered. I will expand on all of them once I find the time.

- I need to set up pagination.
- Text in code blocks has a drop shadow effect.
- Style 404 directly in Obsidian
- 404s shouldn't show up in the sitemap, I want to fine tune what's in there
- Better feeds (hiding items, the stuff above with the slashes, not showing 404)

## Getting the 404 right
The default setup with 404 has a couple of issues:
- They don't work with GitHub Pages (GitHub doesn't use it as the default 404)
- They show up on the sitemap and on the feed, which doesn't make sense
- Ideally,  I'd like to style/edit them directly from within Obsidian

### Edit 404s within Obsidian
**Status:** Resolved ‚úÖ

**Description:** To have better control over what the 404 page looks like, I would like to edit it in Obsidian.

**Solution:**
This one is fairly easy:
- In the template repository, delete `src/site/404.njk`
- In Obsidian, create a note for your 404
- Set `dg-permalink` to `404`
Done!

### Make 404s work with GitHub Pages
**Status:** Resolved ‚úÖ

**Description:** For internal broken links, the Digital Garden links correctly to its 404 page (unless you disabled this, [[#Preventing Dead Links|as I did here]]. For invalid URLs, the default GitHub Pages 404 is displayed.

**Solution:**
==If you did not [[#Edit 404s within Obsidian|set up your own 404 in Obsidian]]==, all you need to do is to add the following front matter to the `src/site/404.njk`:

```
---
permalink: 404.html 
---
```

==If you have set up your own 404==, this requires more work. Simply setting `dg-permalink` to `404.html` does not work, because the plugin transforms this to `/404.html/`, which is not something GitHub Pages can work with. Even setting `dg-pass-frontmatter` to `true` does not prevent this.

==continue here==

## Other
- ==404 in feed and sitemap==

## Getting Titles, Tags and Dates Right
Getting titles, tags and dates show up where I want them and in the format I expected deserves its own section, as it includes addressing several other issues along the way.

The core issue is: _either_ you steer displaying of the header, dates and tags directly in Obsidian. However, this comes at a few disadvantages:
- If you use the search, all this extra stuff which should arguably be part of a header or footer pollutes the search results
- The same applies for the rss feed.
- If you rely extensively on DataView e.g. to display the last edited time, you will quickly run into performance issues.
- Footnotes will always go below your note, so if you have a footer inside of your note, the footnotes will go below that.

_Or_ you take the alternatives the template comes with, in which case you have to live with how the template wants your notes to look, or roll up your sleeves and get working, as I did.

### Other Issues
- Kebab-case front matter not recognized
- I want clickable tags, but no search
- The permalink needs to stay stable even If the title isn‚Äôt
- compile fails if permalink is number
- I want to see the title in my file, but the setup prevents me to do so
- built-in header components (timestamp, tags, H1) have issued
- I want to use excerpts for feeds and metadata
- og:title and these things
